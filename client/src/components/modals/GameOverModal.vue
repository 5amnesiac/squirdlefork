<template>
	<Modal id="game-over-modal" ref="game-over-modal" modalID="game-over-modal">
		<div id="game-over">
			<h2 id="game-over-header">Today's Pok√©mon</h2>
			<img
				id="target-sprite"
				alt="Target Pokemon"
				:class="gameOver ? 'show' : 'hidden'"
			/>
			<img
				id="mystery-sprite"
				:class="gameOver ? 'hidden' : 'show'"
				src="@/assets/icons/mystery.png"
				alt="Mystery Pokemon"
			/>
			<p v-if="gameOver" id="target-name">
				#{{ target.dex_num.toString().padStart(3, "0") }}:
				{{ target.name }}
			</p>
			<p v-else id="target-name">???</p>
			<div id="tile-container" :class="gameOver ? 'show' : 'hidden'">
				<div class="target-tile">
					<img alt="Box Sprite" id="target-box-sprite" />
				</div>
				<div class="target-tile">{{ intToRoman(target.gen) }}</div>
				<div class="target-tile">
					<img id="target-primary-type" alt="Type 1 Plaque" />
					<img
						v-if="target.type_2"
						id="target-secondary-type"
						alt="Type 2 Plaque"
					/>
				</div>
				<div class="target-tile">{{ intToRoman(target.stage) }}</div>
				<div class="target-tile">{{ target.name.length }}</div>
			</div>
		</div>
	</Modal>
</template>

<script>
// Import global component
import Modal from "@/components/global/Modal.vue";

export default {
	name: "GameOver",
	components: {
		Modal,
	},
	props: {
		gameOver: {
			type: Boolean,
			default: true,
		},
		target: {
			type: Object,
			required: true,
		},
	},
	methods: {
		// Modal control
		openModal: function () {
			this.$refs["game-over-modal"].openModal();
		},
		// Convert numbers to roman numerals
		intToRoman: function (num) {
			switch (num) {
				case 1:
					return "I";
				case 2:
					return "II";
				case 3:
					return "III";
				case 4:
					return "IV";
				case 5:
					return "V";
				case 6:
					return "VI";
				case 7:
					return "VII";
				case 8:
					return "VIII";
			}
		},
		// Dyanamically set images
		setImages: function () {
			// Set main sprite
			document.getElementById(
				"target-sprite"
			).src = `https://projectpokemon.org/images/normal-sprite/${this.target.name}.gif`;
			// Set box sprite
			document.getElementById(
				"target-box-sprite"
			).src = `https://www.serebii.net/pokedex-swsh/icon/${this.target.dex_num
				.toString()
				.padStart(3, "0")}.png`;
			// Set types
			document.getElementById(
				"target-primary-type"
			).src = `https://www.serebii.net/pokedex-bw/type/${this.target.type_1}.gif`;
			if (this.target.type_2 !== "")
				document.getElementById(
					"target-secondary-type"
				).src = `https://www.serebii.net/pokedex-bw/type/${this.target.type_2}.gif`;
		},
	},
	mounted: function () {
		this.setImages();
	},
};
</script>

<style lang="scss" scoped>
#game-over {
	height: 100%;
	width: 100%;

	#game-over-header {
		font-family: $alt-font;
		font-size: 1.2rem;
		line-height: 1.2rem;
		color: white;
		text-decoration: underline;
		margin-bottom: 16px;
	}

	#target-sprite {
        margin: 16px auto;
		margin-top: 32px;
	}

	#mystery-sprite {
		margin: 16px auto;
		margin-top: 32px;
		height: 150px;
	}

	#target-name {
		font-family: $alt-font;
		font-size: 1.2rem;
		color: white;
		letter-spacing: 2px;
	}

	#tile-container {
		justify-content: space-between;
		margin: 8px auto;
		width: 75%;

		.target-tile {
			border: 1px solid $tile-color;
			height: 50px;
			width: 50px;
			display: flex;
			flex-direction: column;
			justify-content: space-evenly;
			align-items: center;
			font-size: 1.5rem;
			color: white;
			line-height: 45px;
			font-family: $alt-font;
		}
	}

	.show {
		display: flex;
	}

	.hidden {
		display: none;
	}
}
</style>
